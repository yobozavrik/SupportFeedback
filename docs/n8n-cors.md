# Налаштування CORS для вебхука n8n

Ця інструкція допомагає дозволити відправку форми з фронтенду, який знаходиться на іншому домені, ніж інстанс n8n. Додавання заголовка `Access-Control-Allow-Origin` у відповідь вебхука знімає блокування запитів браузером.

## 1. Додайте заголовок у Webhook node
1. Відкрийте workflow, який приймає звернення з форми (наприклад, той, де налаштований webhook `supporttest`).
2. Виберіть **Webhook** node, що обробляє HTTP-запит.
3. На вкладці **Response** розгорніть секцію **Response Headers** та натисніть **Add Header**.
4. Вкажіть ключ `Access-Control-Allow-Origin`, а значення встановіть на потрібний домен (наприклад, `https://feedback.galabaluvana.ua`). Для тестування можна тимчасово використати `*`, але у продакшені слід зазначати конкретний домен.
5. Збережіть workflow (`Save`) і опублікуйте зміни (`Activate` або `Execute workflow` залежно від сценарію).

> Якщо webhook генерує відповідь в іншому вузлі (наприклад, у **Respond to Webhook**), додайте заголовок у полі **Additional Headers** саме там.

## 2. Перезапустіть n8n
Після зміни налаштувань бажано перезапустити сервіс, щоб переконатися, що n8n використовує нові конфігурації.

- Docker: `docker compose restart n8n`
- Systemd: `sudo systemctl restart n8n`
- n8n Cloud: вимкніть та знову активуйте workflow через UI.

## 3. Перевірте результат у DevTools
1. Відкрийте сторінку з формою та запустіть DevTools → **Network**.
2. Надішліть тестове звернення.
3. Оберіть запит до вебхука у списку мережевих запитів.
4. На вкладці **Headers** переконайтеся, що у відповіді сервера є `Access-Control-Allow-Origin` із очікуваним значенням.
5. Якщо запит завершився успішно і заголовок присутній, CORS більше не блокує інтеграцію.

Для додаткової впевненості можна зробити контрольний запит із терміналу:

```bash
curl -i -X OPTIONS https://your-n8n-domain/webhook/supporttest
```

У відповіді має бути заголовок `Access-Control-Allow-Origin`.
